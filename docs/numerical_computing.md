# 数值计算基础

## 1. 基本概念

数值计算是使用计算机进行数学计算的方法，它涉及将连续数学问题转化为离散的数值问题，并通过算法求解。

### 1.1 数值计算的特点

- **近似性**：用有限精度表示无限精度的数学对象
- **离散性**：将连续问题离散化处理
- **有限性**：受计算机存储和计算能力限制
- **误差性**：不可避免地引入各种误差

## 2. 误差类型

### 2.1 截断误差 (Truncation Error)

**定义**：由于用有限项近似无限过程而产生的误差。

**常见来源**：
- 泰勒展开截断
- 数值积分近似
- 迭代算法提前终止
- 微分方程数值求解

**例子**：
$$\sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots$$

如果只取前3项：$\sin(x) \approx x - \frac{x^3}{6} + \frac{x^5}{120}$，则截断误差为：
$$E = \left|\sin(x) - \left(x - \frac{x^3}{6} + \frac{x^5}{120}\right)\right|$$

### 2.2 舍入误差 (Rounding Error)

**定义**：由于计算机浮点数表示精度限制而产生的误差。

**IEEE 754 标准**：
- **单精度**：32位，约7位有效数字
- **双精度**：64位，约15-16位有效数字
- **扩展精度**：80位，约19位有效数字

**舍入模式**：
- 向最近值舍入（默认）
- 向零舍入
- 向正无穷舍入
- 向负无穷舍入

### 2.3 相对误差与绝对误差

**绝对误差**：$E_{abs} = |x - \hat{x}|$

**相对误差**：$E_{rel} = \frac{|x - \hat{x}|}{|x|}$

**有效数字**：如果 $E_{rel} \leq 5 \times 10^{-n}$，则称 $\hat{x}$ 有 $n$ 位有效数字。

## 3. 数值稳定性

### 3.1 条件数 (Condition Number)

**定义**：衡量问题对输入扰动的敏感程度。

对于线性方程组 $Ax = b$：
$$\kappa(A) = \|A\| \|A^{-1}\|$$

**条件数分类**：
- $\kappa < 10$：良条件
- $10 \leq \kappa < 100$：中等条件
- $\kappa \geq 100$：病态条件

### 3.2 数值稳定性分类

**前向稳定**：计算结果的误差与输入误差成比例。

**后向稳定**：计算结果是某个邻近问题的精确解。

**混合稳定**：结合前向和后向稳定性。

## 4. 数值积分

### 4.1 基本概念

**目标**：计算定积分 $\int_a^b f(x)dx$ 的近似值。

**基本思想**：将积分区间分割，用简单函数近似被积函数。

### 4.2 常用方法

#### 4.2.1 矩形法则
$$\int_a^b f(x)dx \approx h \sum_{i=0}^{n-1} f(x_i)$$

其中 $h = \frac{b-a}{n}$，$x_i = a + ih$。

#### 4.2.2 梯形法则
$$\int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{i=1}^{n-1} f(x_i) + f(b)]$$

#### 4.2.3 辛普森法则
$$\int_a^b f(x)dx \approx \frac{h}{3}[f(a) + 4\sum_{i=1}^{n/2} f(x_{2i-1}) + 2\sum_{i=1}^{n/2-1} f(x_{2i}) + f(b)]$$

**精度比较**：
- 矩形法则：$O(h)$
- 梯形法则：$O(h^2)$
- 辛普森法则：$O(h^4)$

### 4.3 自适应积分

**思想**：根据函数变化自动调整步长。

**Romberg 积分**：结合 Richardson 外推法提高精度。

## 5. 数值微分

### 5.1 有限差分

#### 5.1.1 前向差分
$$f'(x) \approx \frac{f(x+h) - f(x)}{h}$$

#### 5.1.2 后向差分
$$f'(x) \approx \frac{f(x) - f(x-h)}{h}$$

#### 5.1.3 中心差分
$$f'(x) \approx \frac{f(x+h) - f(x-h)}{2h}$$

**精度比较**：
- 前向/后向差分：$O(h)$
- 中心差分：$O(h^2)$

### 5.2 高阶导数

**二阶导数**：
$$f''(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}$$

## 6. 线性方程组求解

### 6.1 直接方法

#### 6.1.1 高斯消元法
**步骤**：
1. 前向消元：将矩阵化为上三角矩阵
2. 回代：求解上三角方程组

**复杂度**：$O(n^3)$

#### 6.1.2 LU 分解
将矩阵 $A$ 分解为 $A = LU$，其中 $L$ 是下三角矩阵，$U$ 是上三角矩阵。

**优点**：可以重复使用分解结果求解多个右端项。

### 6.2 迭代方法

#### 6.2.1 雅可比迭代
$$x_i^{(k+1)} = \frac{1}{a_{ii}}\left(b_i - \sum_{j \neq i} a_{ij}x_j^{(k)}\right)$$

#### 6.2.2 高斯-赛德尔迭代
$$x_i^{(k+1)} = \frac{1}{a_{ii}}\left(b_i - \sum_{j<i} a_{ij}x_j^{(k+1)} - \sum_{j>i} a_{ij}x_j^{(k)}\right)$$

**收敛条件**：矩阵 $A$ 严格对角占优或正定。

## 7. 非线性方程求解

### 7.1 二分法

**条件**：$f(a) \cdot f(b) < 0$（函数在区间端点异号）

**步骤**：
1. 取中点 $c = \frac{a+b}{2}$
2. 计算 $f(c)$
3. 根据符号选择新的区间
4. 重复直到满足精度要求

**收敛速度**：线性收敛，每次迭代误差减半。

### 7.2 牛顿法

**迭代公式**：
$$x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$$

**收敛条件**：
- $f'(x) \neq 0$ 在根附近
- 初始值足够接近根

**收敛速度**：二次收敛。

### 7.3 割线法

**迭代公式**：
$$x_{n+1} = x_n - f(x_n) \frac{x_n - x_{n-1}}{f(x_n) - f(x_{n-1})}$$

**优点**：不需要计算导数。

**收敛速度**：超线性收敛。

## 8. 常微分方程数值求解

### 8.1 欧拉方法

**显式欧拉**：
$$y_{n+1} = y_n + h \cdot f(x_n, y_n)$$

**隐式欧拉**：
$$y_{n+1} = y_n + h \cdot f(x_{n+1}, y_{n+1})$$

**精度**：一阶方法，局部截断误差 $O(h^2)$。

### 8.2 龙格-库塔方法

#### 8.2.1 经典四阶龙格-库塔
$$k_1 = f(x_n, y_n)$$
$$k_2 = f(x_n + \frac{h}{2}, y_n + \frac{h}{2}k_1)$$
$$k_3 = f(x_n + \frac{h}{2}, y_n + \frac{h}{2}k_2)$$
$$k_4 = f(x_n + h, y_n + hk_3)$$
$$y_{n+1} = y_n + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$

**精度**：四阶方法，局部截断误差 $O(h^5)$。

### 8.3 多步法

#### 8.3.1 亚当斯-巴什福斯方法（显式）
$$y_{n+1} = y_n + \frac{h}{12}(23f_n - 16f_{n-1} + 5f_{n-2})$$

#### 8.3.2 亚当斯-莫尔顿方法（隐式）
$$y_{n+1} = y_n + \frac{h}{12}(5f_{n+1} + 8f_n - f_{n-1})$$

## 9. 插值与逼近

### 9.1 拉格朗日插值

**插值多项式**：
$$P_n(x) = \sum_{i=0}^n y_i \prod_{j=0, j \neq i}^n \frac{x - x_j}{x_i - x_j}$$

**缺点**：高次插值可能产生龙格现象。

### 9.2 牛顿插值

**差商定义**：
$$f[x_0, x_1, ..., x_k] = \frac{f[x_1, ..., x_k] - f[x_0, ..., x_{k-1}]}{x_k - x_0}$$

**插值多项式**：
$$P_n(x) = f[x_0] + \sum_{k=1}^n f[x_0, ..., x_k] \prod_{i=0}^{k-1}(x - x_i)$$

### 9.3 样条插值

**三次样条**：在每个子区间上使用三次多项式，保证函数值和一阶、二阶导数连续。

**优点**：避免龙格现象，具有良好的数值稳定性。

## 10. 特征值问题

### 10.1 幂法

**基本思想**：通过迭代 $x_{k+1} = Ax_k$ 找到主特征值。

**算法**：
1. 选择初始向量 $x_0$
2. 计算 $y_{k+1} = Ax_k$
3. 计算 $\lambda_{k+1} = \frac{y_{k+1}^T x_k}{x_k^T x_k}$
4. 归一化：$x_{k+1} = \frac{y_{k+1}}{\|y_{k+1}\|}$

**收敛条件**：主特征值唯一且模最大。

### 10.2 QR 算法

**基本思想**：通过 QR 分解迭代将矩阵化为上三角形式。

**步骤**：
1. $A_0 = A$
2. $A_k = Q_k R_k$（QR 分解）
3. $A_{k+1} = R_k Q_k$
4. 重复直到收敛

## 11. 数值计算中的常见问题

### 11.1 病态问题

**表现**：输入的小扰动导致输出的大变化。

**解决方法**：
- 使用更稳定的算法
- 提高计算精度
- 重新表述问题

### 11.2 数值不稳定

**表现**：舍入误差在计算过程中被放大。

**解决方法**：
- 使用数值稳定的算法
- 避免相近数相减
- 合理安排计算顺序

### 11.3 维度诅咒

**表现**：高维空间中距离集中，相似性度量失效。

**解决方法**：
- 降维技术（PCA、t-SNE）
- 其他距离度量
- 专门的高维算法

## 12. 实用建议

### 12.1 算法选择原则

1. **精度要求**：根据精度需求选择合适的方法
2. **计算效率**：考虑时间复杂度和空间复杂度
3. **数值稳定性**：优先选择数值稳定的算法
4. **问题特性**：根据问题特点选择专门方法

### 12.2 误差控制策略

1. **误差分析**：分析各种误差的来源和大小
2. **精度匹配**：确保计算精度与问题需求匹配
3. **自适应方法**：根据误差情况动态调整参数
4. **验证结果**：使用多种方法验证计算结果

### 12.3 编程实践

1. **使用标准库**：优先使用经过验证的数值计算库
2. **注意数据类型**：选择合适的数值类型
3. **避免数值陷阱**：注意溢出、下溢、除零等问题
4. **测试边界情况**：测试极端输入下的算法行为

## 13. 常用数值计算库

### 13.1 Python
- **NumPy**：基础数值计算
- **SciPy**：科学计算
- **SymPy**：符号计算
- **Pandas**：数据分析

### 13.2 MATLAB
- 内置丰富的数值计算函数
- 专业的数值分析工具箱

### 13.3 C/C++
- **GSL**：GNU 科学计算库
- **BLAS/LAPACK**：线性代数库
- **Intel MKL**：Intel 数学核心库

### 13.4 Julia
- 专为科学计算设计
- 高性能数值计算

## 14. 总结

数值计算是连接数学理论与实际应用的重要桥梁。掌握数值计算的基本概念、方法和技巧，对于科学计算、工程应用和数据分析都具有重要意义。

**关键要点**：
1. 理解各种误差的来源和性质
2. 掌握常用数值方法的原理和适用条件
3. 学会分析算法的数值稳定性
4. 能够根据问题特点选择合适的数值方法
5. 注意数值计算的实践技巧和常见陷阱

通过系统学习数值计算，可以更好地解决实际工程和科学问题，提高计算结果的可靠性和效率。
